layout: FLAT

group: io.github.aaziz993

plugins:
  # Can format <antlr | c | c# | c++ | css | flow | graphql | groovy | html | java | javascript | json | jsx | kotlin | less | license headers | markdown | objective-c | protobuf | python | scala | scss | shell | sql | typeScript | vue | yaml | anything> using <gradle | maven | sbt | anything>.
  spotless:
    enabled: true
    kotlinGradle:
      ktlint:
        editorConfigPath: ../.editorconfig

  # Set of solutions for collecting test coverage of Kotlin code compiled for JVM and Android platforms.
  kover:
    enabled: true
    useJacoco: true
    reports:
      total:
        html:
          title: Generate coverage report
          htmlDir: build/reports/kover
          onCheck: true
          charset: UTF8
        xml:
          xmlFile: build/reports/kover/report.xml
          onCheck: true

  # Help developers deliver high-quality, efficient code standards that benefit the entire team or organization.
  sonar:
    enabled: true
    properties:
      sonar.host.url: https://sonarcloud.io
      sonar.organization: aaziz993
      sonar.projectKey: aaziz993_compose-multiplatform
      sonar.coverage.jacoco.xmlReportPaths: build/reports/kover/report.xml
      sonar.androidLint.reportPaths: build/reports/lint-results.xml

  # api documentation engine for Kotlin.
  dokka:
    enabled: true

  # allows dumping binary API of a JVM part of a Kotlin library that is public in the sense of Kotlin visibilities and ensures that the public binary API wasn't changed in a way that makes this change binary incompatible.
  apiValidation:
    enabled: true
    apiDumpDirectory: api-validation
    klib:
      enabled: true
      strictValidation: true

  # api that you can use to develop lightweight compiler plugins. KSP provides a simplified compiler plugin API that leverages the power of Kotlin while keeping the learning curve at a minimum. Compared to KAPT, annotation processors that use KSP can run up to 2x faster.
  ksp:
    enabled: true
    useKsp2: true
    processors:
      - $libs.arrow.optics.ksp.plugin
      - $libs.androidx.room.compiler
      - $libs.ktorfit.ksp
      # Use import org.koin.ksp.generated.*
      - $libs.koin.ksp.compiler

  # Generating BuildConstants for any kind of Gradle projects: Java, Kotlin, Android, Groovy, etc. Designed for KTS scripts, with experimental support for Kotlin's multi-platform plugin
  buildConfig:
    enabled: true

  # adapts Kotlin to the requirements of those frameworks and makes classes annotated with a specific annotation and their members open
  allOpen:
    enabled: true
    myAnnotations:
      - javax.ws.rs.Path
      - javax.enterprise.context.ApplicationScoped
      - javax.persistence.Entity
      - data.type.annotation.AllOpen

  # generates an additional zero-argument constructor for classes with a specific annotation.
  noArg:
    myAnnotations:
      - data.type.annotation.NoArg

  # compiler plugin, that generates visitor code for serializable classes, runtime library with core serialization API and support libraries with various serialization formats.
  serialization:
    enabled: true
    version: 1.8.0

  # multiplatform library that provides the idiomatic and efficient way of using atomic operations in Kotlin.
  atomicFU:
    enabled: true

  # generates typesafe Kotlin APIs from your SQL statements. It verifies your schema, statements, and migrations at compile-time and provides IDE features like autocomplete and refactoring which make writing and maintaining SQL simple.
  sqldelight:
    linkSqlite: true

  # abstraction layer over SQLite to allow for more robust database access while harnessing the full power of SQLite.
  room:
    enabled: true
    schemaDirectories:
      - schemas

  # kotlin library for adding asynchronous Remote Procedure Call (RPC) services to your applications. Build your RPC with already known language constructs and nothing more!
  rpc:
    enabled: true
    annotationTypeSafetyEnabled: true

  # http client/Kotlin Symbol Processor for Kotlin Multiplatform ( Android, iOS, Js, Jvm, Linux) using KSP and Ktor clients inspired by Retrofit
  ktorfit:
    enabled: true
    generateQualifiedTypeName: true

  # strongly typed GraphQL client that generates Kotlin models for your GraphQL operations.
  apollo:
    enabled: true
    generateSourcesDuringGradleSync: true

  # providing detailed failure messages with contextual information during testing.
  powerAssert:
    enabled: true
    functions:
      - kotlin.assert
      - kotlin.test.assertTrue
      - kotlin.test.assertEquals
      - kotlin.test.assertNull
      - kotlin.test.assertFails
      - kotlin.test.assertFailsWith

    includedSourceSets:
      - commonMain
      - jvmMain
      - androidMain
      - nativeMain
      - jsMain
      - wasmJsMain

kotlin:
  jvmToolchain: 23

  compilerOptions:
    allWarningsAsErrors: false
    debug: false
    progressiveMode: true
    suppressWarnings: false
    verbose: true
    languageFeatures:
      - ContextReceivers
      - ExplicitBackingFields
    freeCompilerArgs:
      - -Xexplicit-api=strict
      - -Xexport-kdoc
      - -Xinline-classes
      - -Xwhen-guards
      - -Xnon-local-break-continue
      - -Xexpect-actual-classes
      - -Xcontext-receivers
      - -Xmulti-dollar-interpolation
      - -Xrender-internal-diagnostic-names
    optIns:
      - kotlin.RequiresOptIn, kotlin.ExperimentalSubclassOptIn
      - kotlin.ExperimentalStdlibApi
      - kotlin.ExperimentalUnsignedTypes
      - kotlin.ExperimentalUuidApi
      - kotlin.time.ExperimentalTime
      - kotlin.contracts.ExperimentalContracts
      - kotlin.experimental.ExperimentalObjCName
      - kotlin.js.ExperimentalJsExport
      - kotlinx.coroutines.ExperimentalCoroutinesApi
      - kotlinx.coroutines.DelicateCoroutinesApi
      - kotlinx.coroutines.FlowPreview
      - kotlinx.serialization.ExperimentalSerializationApi
      - kotlinx.serialization.InternalSerializationApi
      - dev.whyoleg.cryptography.DelicateCryptographyApi

  sourceSets:
    commonMain:
      dependencies:
        - $libs.kotlinx.serialization.json
        - $libs.kotlinx.serialization.properties

    nonWeb:
      dependencies:
        - $libs.androidx.room.runtime.ktx

    jvmMain:
      dependencies:
        - $libs.kotlinx.coroutines.swing

    androidMain:
      dependencies:
        - $libs.androidx.activity.ktx
        - $libs.androidx.fragment.ktx
        - $libs.androidx.room.runtime.android
        - $libs.androidx.room.paging

    jsMain:
      dependencies:
        - npm: $libs.js.joda.timezone
        - npm: $libs.npm.copy.webpack.plugin
        - npm: $libs.npm.openpgp
        - npm: $libs.npm.pako
        - npm: $libs.npm.puppeteer

#    wasmJsMain:
#      dependencies:
#        - $kotlinWrappers.browser

#
#
#jvm:
#  release: 23
#  freeCompilerArgs:
#    - -Xjvm-default=all

#  native:
#    binaries:
#      framework:
#        freeCompilerArgs:
#          - -Xexport-kdoc
#          - -Xallocator=custom
#          - -XXLanguage+ImplicitSignedToUnsignedIntegerConversion
#          - -Xadd-light-debug=enable
#        optIns:
#          - kotlin.experimental.ExperimentalObjCName
#          - kotlinx.cinterop.ExperimentalForeignApi
#          - kotlinx.cinterop.BetaInteropApi
#
#        # add it to avoid sqllite3 issues in iOS. Required when using NativeSQLiteDriver
#        linkerOpts:
#          - -lsqlite3
#
#  js:
#    optIns:
#      - kotlin.js.ExperimentalJsExport
application:
  mainClass: ApplicationKt
  applicationDefaultJvmArgs:
    - -Dio.ktor.development=true

android:
  defaultConfig:
    testInstrumentationRunner: androidx.test.runner.AndroidJUnitRunner

    manifestPlaceholders:
      appAuthRedirectScheme: "empty"

    vectorDrawables:
      useSupportLibrary: true

    # List additional ProGuard rules for the given build type here. By default,
    # Android Studio creates and includes an empty rules file for you (located
    # at the root directory of each module).
    proguardFiles: [ consumer-proguard.pro ]
    # The proguard files listed here are included in the
    # test APK only.
    testProguardFiles: [ test-proguard-rules.pro ]
    consumerProguardFiles: [ consumer-proguard.pro ]

  buildTypes:
    - release:
        isMinifyEnabled: true
        debuggable: false
    - debug:
        isMinifyEnabled: false
        debuggable: true

  packagingOptions:
    resources:
      excludes: /META-INF/{AL2.0,LGPL2.1

  buildFeatures:
    buildConfig: true
    viewBinding: true

  lintOptions:
    checkReleaseBuilds: false
    abortOnError: false

  compileOptions:
    isCoreLibraryDesugaringEnabled: true

dependencies:
  - $libs.compose.lint.checks: lintChecks
  - $libs.android.desugar.jdk.libs
  - $libs.androidx.test.core
  - $libs.androidx.test.runner

tasks:
  dokkaTask:
    outputDirectory: build/dokka
