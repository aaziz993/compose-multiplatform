type: APP

description: Compose multiplatform application.

templates:
  - ../templates/gradle/jvm/jvm.yaml
  - ../templates/gradle/android/android.yaml
  - ../templates/gradle/android/android-app.yaml
  - ../templates/gradle/jvm-common.yaml
  - ../templates/gradle/apple.yaml
  - ../templates/gradle/web/js/js.yaml
  - ../templates/gradle/web/js/js-executable.yaml
  - ../templates/gradle/web/wasmJs.yaml
  - ../templates/gradle/web/wasm-executable.yaml
  - ../templates/gradle/web/js-common.yaml
  - ../templates/gradle/mpp.yaml
  - ../templates/gradle/compose.yaml
  - ../templates/gradle/common.yaml
  - ../templates/gradle/root.yaml

kotlin:
  sourceSets:
    - commonMain:
        dependencies:
          - :kmp-lib
          - :cmp-lib
          - :shared

compose:
  desktop:
    application:
      mainClass: MainKt
      jvmArgs:
        - --add-opens=java.desktop/sun.awt=ALL-UNNAMED
        - --add-opens=java.desktop/java.awt.peer=ALL-UNNAMED
        # for mac
        - --add-opens=java.desktop/sun.lwawt=ALL-UNNAMED
        - --add-opens=java.desktop/sun.lwawt.macosx=ALL-UNNAMED
      nativeDistributions:
        targetFormats: [ Dmg, Msi, Deb ]
        # jpackage only supports .png on Linux, .ico on Windows, .icns on Mac, so a developer must do a conversion (probably from a png) to a 3 different formats.
        # Also it seems that ico and icns need to contain an icon in multiple resolutions, so the conversion becomes a bit inconvenient.
        macOS:
          iconFile: composeResources/drawable/compose-multiplatform.icns
        linux:
          iconFile: composeResources/drawable/compose-multiplatform.png
        windows:
          iconFile: composeResources/drawable/compose-multiplatform.ico
      buildTypes:
        release:
          proguard:
            configurationFiles: [ compose-desktop.pro ]
