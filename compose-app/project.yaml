type: APP

templates:
  - ../template/kmp.yaml
  - ../template/cmp.yaml
  - ../template/common.yaml

kotlin:
  sourceSets:
    - commonMain:
        dependencies:
          - :kmp-lib
          - :cmp-lib
          - :shared

android:
  buildFeatures:
    compose: true

compose:
  desktop:
    application:
      mainClass: MainKt
      jvmArgs:
        - --add-opens=java.desktop/sun.awt=ALL-UNNAMED
        - --add-opens=java.desktop/java.awt.peer=ALL-UNNAMED
        # for mac
        - --add-opens=java.desktop/sun.lwawt=ALL-UNNAMED
        - --add-opens=java.desktop/sun.lwawt.macosx=ALL-UNNAMED
      nativeDistributions:
        targetFormats: [ Dmg, Msi, Deb ]
        # jpackage only supports .png on Linux, .ico on Windows, .icns on Mac, so a developer must do a conversion (probably from a png) to a 3 different formats.
        # Also it seems that ico and icns need to contain an icon in multiple resolutions, so the conversion becomes a bit inconvenient.
        macOS:
          iconFile: composeResources@jvm/drawable/MacOSIcon.icns
        linux:
          iconFile: composeResources@jvm/drawable/LinuxIcon.png
        windows:
          iconFile: composeResources@jvm/drawable/WindowsIcon.ico
      buildTypes:
        release:
          proguard:
            configurationFiles: [ compose-desktop.pro ]
