imports:
  - ../../ksp.yaml
  - ../../power-assert.yaml
script:
  - kotlin:
      applyDefaultHierarchyTemplate: |
        {
          common {
            group("jvmAndroid") {
              withJvm()
              withAndroidTarget("jvmAndroid")
            }
            group("ios") {
              withIos()
            }
            group("watchos32") {
              withWatchosArm32()
              withWatchosArm64()  // NB watchosArm64 is weird target w/ 32-bit numbers.
            }
            group("watchos64") {
              withWatchosX64()
              withWatchosDeviceArm64()
              withWatchosSimulatorArm64()
            }
            group("macos") {
              withMacos()
            }
            group("tvos") {
              withTvos()
            }
            group("linux") {
              withLinux()
            }
            group("mingw") {
              withMingw()
            }
            group("jvmAndroidApple") {
              group("jvmAndroid")
              group("apple")
            }
            group("jvmWebApple") {
              group("jvmWeb")
              group("apple")
            }
            group("jvmWeb") {
              withJvm()
              group("web")
            }
            group("androidIos") {
              withAndroidTarget("androidIos")
              group("ios")
            }
            group("androidIosWeb") {
              group("androidIos")
              group("web")
            }
            group("androidNative32") {
              withAndroidNativeArm32()
              withAndroidNativeX86()
            }
            group("androidNative64") {
              withAndroidNativeX64()
              withAndroidNativeArm64()
            }
            group("androidNative") {
              group("androidNative32")
              group("androidNative64")
            }
            group("apple32") {
              group("watchos32")
            }
            group("apple64") {
              group("ios")
              group("macos")
              group("tvos")
              group("watchos64")
            }
            group("apple") {
              group("apple32")
              group("apple64")
            }
            group("jvmAndroidWeb") {
              group("jvmAndroid")
              group("jvmWeb")
            }
            group("unix") {
              group("linux")
              group("androidNative")
            }
            group("nix") {
              group("unix")
              group("apple")
            }
            group("posix") {
              group("nix")
              group("mingw")
            }
            group("unixMingw") {
              group("unix")
              group("mingw")
            }
            group("appleLinuxMingw") {
              group("apple")
              group("linux")
              group("mingw")
            }
            group("desktop") {
              group("linux")
              group("mingw")
              group("macos")
            }
            group("native") {
              group("posix")
              group("unixMingw")
              group("appleLinuxMingw")
              group("desktop")
            }
            group("multithreaded") {
              group("jvmAndroid")
              group("native")
            }
            group("wasm") {
                withWasmJs()
                withWasmWasi()
            }
          }
        }
  - ksp:
      # room
      - arg: ("room.incremental", "true")
      - arg: ("room.expandProjection", "true")
  - powerAssert:
      includeKotlinSourceSets: ()
  - dependencies:
      - ksp: (libs["arrow.optics.ksp.plugin"])
      - ksp: (libs["androidx.room.compiler"])
      # Supports only kotlin source sets default layout.
      # - ksp: (libs["ktorfit.ksp"])
      # Use import org.koin.ksp.generated.* in project.
      - ksp: (libs["koin.ksp.compiler"])
      - add: ("kspCommonMainMetadata", dependencies.project(":lib-ksp"))
